<div class="row-fluid">
  <div class="span3">
    <div class="widget <%= @tournament.game.decorate.html_class %>" id="primary-game">
      <h3>Game</h3>
      <h4><%= @tournament.game.try(:display_name) %></h4>
    </div>
    <div class="well well-small">Starts: <%= ldate @tournament.signup_ends_at %></div>
    <%= render "registration_widget" %>
    <div class="well well-small">
      <div class="row-fluid">
        <div class="span6">
          <% if @tournament.stream_slug.present? %>
            <%= link_to "Stream", stream_url(@tournament.stream_slug), class: "btn btn-block" %>
          <% end %>
        </div>
        <div class="span6">
          <%= link_to "Brackets", "#", class: "btn btn-block" %>
        </div>
      </div>
    </div>
    <div class="widget">
      <div class="widget-header">
        <h3>Rules</h3>
      </div>
      <div class="widget-content">
        <%= @tournament.details %>
      </div>
    </div>
    <div class="widget">
      <div class="widget-header">
        <h3>Maps</h3>
      </div>
      <div class="widget-content">
        <%= @tournament.maps %>
      </div>
    </div>
    <div id="prize-pool-widget" class="widget">
      <div class="widget-header">
        <h3>Prize Pool</h3>
      </div>
      <div class="widget-content scrollable">
        <table class="table table-bordered table-striped">
          <tbody>
            <% @tournament.prizepool.each do |placement, amount| %>
              <tr>
                <td><%= label placement, ActiveSupport::Inflector.ordinalize(placement) %></td>
                <td><%= number_to_currency amount %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
    <div id="collaborators-widget" class="widget">
      <div class="widget-header">
        <h3>Collaborators</h3>
      </div>
      <div class="widget-content scrollable">
        <% @tournament.collaborators.each do |collaborator| %>
          <div class="control-group">
            <div class="controls">
              <%= User.find(collaborator).username rescue "" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  <div class="span9">
    <div id="tournament-name-wrapper" class="row-fluid widget">
      <div class="span1 tournament-thumb"><img src="//placehold.it/80x80"></div>
      <div class="span8 widget-content">
        <h3>
          <%= @tournament.name %>

          <% if @tournament.owner === current_user %>
            <%= link_to "Destroy", @tournament, method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-mini btn-danger pull-right" %>
          <% end %>
        </h3>
        <h4>Owner: <%= @tournament.owner.try(:username) %></h4>
      </div>
      <div class="span3 widget-content game-type">
        <div class="span12">
          <h4><%= @tournament.game_type.try(:name) %></h4>
        </div>
        <div class="span12">
          <h4><%=t @tournament.format %></h4>
        </div>
      </div>
    </div>
    <div class="span9 middle-content">
      <div id="registration-cycle" class="widget">
        <div class="widget-header">
          <h3>Registration cycle</h3>
        </div>
        <div>
          <div class="span6">
            <div class="span6 sub-label">
              <h4>Sign-Up Ends At</h4>
            </div>
            <div class="span6 sub-time-date">
              <h4><%= @tournament.signup_ends_at.strftime("%x") %></h4>
              <h3><%= @tournament.signup_ends_at.strftime("%H:%M %p") %></h3>
            </div>
          </div>
        </div>
      </div>
      <div id="registration-checkin" class="widget">
        <div class="widget-header">
          <h3>Registration checkin</h3>
        </div>
        <div>
          <div class="span6 registration-checkin-content-wrapper">
            <div class="span6 sub-label">
              <h4>Check-In Starts</h4>
            </div>
            <div class="span6 sub-time-date">
              <h4><%= (@tournament.signup_ends_at - @tournament.checkin_hours.hours).strftime("%x") %></h4>
              <h3><%= (@tournament.signup_ends_at - @tournament.checkin_hours.hours).strftime("%H:%M %p") %></h3>
            </div>
          </div>
        </div>
      </div>
      <%= render "registered_players" %>
    </div>
    <div class="span2">
      <%= render "sponsors" %>
    </div>
  </div>
</div>
